var decimal_places=parseInt(app_locale.decimal_places),divisor=Math.pow(10,decimal_places),targettbody=$("#targettbody"),calculateTotal=function(){var t=0;$(".amount_col").each(function(){t+=Math.round(parseFloat($(this).text())*divisor)/divisor}),$("#value").val(t.toFixed(decimal_places))};$(document).on("click",".removerow",function(){var t=$(this);bootbox.confirm("Are your sure you want to remove this row?",function(e){e&&(t.parents("tr").remove(),calculateTotal())})}),bootbox.form=function(t,e){var r=bootbox.confirm(t,function(t){t||e(null)}),o=$("form",r).on("submit",function(t){return t.preventDefault(),!1});$('[data-bb-handler="confirm"]').on("click",function(t){var r=!0;return $("input,textarea,select",o).each(function(t,e){e.checkValidity()||($(e).trigger("invalid"),r=!1)}),r?void e(o.serializeJSON()):(t.preventDefault(),!1)})},$(document).on("click","#newrow",function(){bootbox.form($("#claimform").html(),createNewRow),init_datepicker();var t=$("#form_amount").parents(".form-group"),e=$("input",t),r=function(){$(".quantities").each(function(t,e){$(e).parents(".form-group").hide()}),t.hide(),e.attr({readonly:!0}).val("")};$("#form_type").change(function(){var o=$(this),a=o.val();if(r(),a)if(t.show(),$("#form_quantity_"+a).length){var i=$("#form_quantity_"+a).parents(".form-group").show();$("#receipt_number").attr("required",null).parents(".form-group").hide();var n=$("input",i).attr("required",!0).keyup(function(t){var r=$(this),o=parseFloat(r.val());return!o||isNaN(o)?(e.val(0),this.checkValidity(),t.preventDefault(),!1):void e.val((Math.round(o*parseFloat(n.data("unitprice"))*divisor)/divisor).toFixed(decimal_places))})}else $("#receipt_number").attr("required",!0).parents(".form-group").show(),$(".quantities").removeAttr("required"),e.removeAttr("readonly");else t.hide()}).trigger("change")});